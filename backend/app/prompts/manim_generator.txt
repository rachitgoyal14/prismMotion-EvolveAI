You are an expert in creating medical animations using Manim (Mathematical Animation Engine).

Generate Manim code for a Mechanism of Action scene with these specifications:

Scene Details:
{scene_json}

**CRITICAL LAYOUT RULES (NO OVERLAPPING, ALL ON SCREEN):**

1. **FRAME SAFE ZONES - Use these positioning rules:**
   - Top safe zone: UP * 3 to UP * 2.5 (for titles)
   - Upper-middle zone: UP * 2 to UP * 0.5 (for subtitles/descriptions)
   - Center zone: UP * 0.5 to DOWN * 0.5 (for main content)
   - Lower-middle zone: DOWN * 0.5 to DOWN * 2 (for captions)
   - Bottom safe zone: DOWN * 2 to DOWN * 3 (for background images)

2. **PREVENT OVERLAPPING:**
   - Always check if elements will overlap BEFORE positioning
   - Use `.get_top()`, `.get_bottom()`, `.get_left()`, `.get_right()` to get boundaries
   - Position new elements relative to existing ones using `.next_to()` with appropriaate buff (0.3-0.5)
   - Keep minimum 0.3 units buffer between all elements
   - Group related elements in VGroup and position the group as one unit

3. **KEEP EVERYTHING ON SCREEN:**
   - Maximum text width: `config.frame_width * 0.85` (leave 15% margins)
   - Maximum element height: `config.frame_height * 0.25` per element
   - Always use `.move_to()` or `.to_edge()` with buff parameter
   - Check bounds: Element center should be within [-6.5, 6.5] horizontally, [-3.5, 3.5] vertically
   - For text, set `width=config.frame_width * 0.8` to auto-wrap and prevent overflow

4. **POSITIONING TEMPLATE:**
```python
# Title (top safe zone)
title = Text("Title", font="Sans", font_size=44, color=BLACK)
title.to_edge(UP, buff=0.5)  # Keeps it on screen with 0.5 buffer

# Subtitle (below title, no overlap)
subtitle = Text("Subtitle", font="Sans", font_size=32, color=BLACK)
subtitle.next_to(title, DOWN, buff=0.4)  # 0.4 buffer prevents overlap

# Main content (center zone, check width)
content = Text("Content...", font="Sans", font_size=28, color=BLACK)
if content.width > config.frame_width * 0.85:
    content.width = config.frame_width * 0.85  # Prevent overflow
content.next_to(subtitle, DOWN, buff=0.5)

# Background image (bottom safe zone, won't overlap with text above)
bg_image.height = config.frame_height * 0.35
bg_image.to_edge(DOWN, buff=0)  # Anchored at bottom
```

**IMAGE HANDLING (CRITICAL FOR PEXELS IMAGES):**
If the scene includes "pexels_image_path", follow these EXACT steps to avoid crashes:

1. **Load image with error handling and safe sizing:**
```python
try:
    bg_image = ImageMobject("{pexels_image_path}")
    # Use 35% of frame height MAX to leave room for text
    bg_image.height = config.frame_height * 0.35  
    bg_image.set_opacity(0.6)
    bg_image.to_edge(DOWN, buff=0)  # Anchor to bottom edge
    # Verify it's on screen
    if bg_image.get_top()[1] > -1.5:  # If image extends too high
        bg_image.height = config.frame_height * 0.25  # Make smaller
except Exception as e:
    bg_image = Rectangle(
        width=config.frame_width,
        height=config.frame_height * 0.35,
        fill_color=BLUE_E,
        fill_opacity=0.2,
        stroke_width=0
    ).to_edge(DOWN, buff=0)
```

2. **Add image to scene WITHOUT animation first (more stable):**
```python
self.add(bg_image)  # Add directly, don't use FadeIn initially
self.play(bg_image.animate.set_opacity(0.7), run_time=1)  # Then animate opacity
```

3. **For fadeout, fade elements separately:**
```python
self.play(
    FadeOut(text_element1),
    FadeOut(text_element2),
    FadeOut(bg_image),  # Fade image separately
    run_time=1
)
```

**WHY THESE RULES:**
- `scale_to_fit_width()` can cause memory issues with large images
- Using `.height = X` is more stable than `.scale_to_fit_width()`
- Adding image first with `self.add()` then animating opacity is more reliable than `FadeIn()`
- Never wrap ImageMobject in nested VGroups for FadeOut
- Always use try/except for image loading

Requirements:
- Use WHITE background (self.camera.background_color = WHITE)
- NO LaTeX fonts - use simple sans-serif text
- Clean, minimal medical illustration style
- Duration: {duration} seconds
- Visual elements: {visual_elements}

CRITICAL IMPORT RULES - YOU MUST FOLLOW THESE:
1. ALWAYS start with: from manim import *
2. ALWAYS import config if using frame dimensions: from manim import config
3. Available constants: UP, DOWN, LEFT, RIGHT, ORIGIN
4. For frame dimensions use: config.frame_width, config.frame_height
5. DO NOT use FRAME_WIDTH or FRAME_HEIGHT directly - they don't exist in newer Manim

Style Guidelines:
- Colors: Use BLUE, RED, GREEN, YELLOW, PURPLE (from manim import *)
- Custom colors: medical_blue = "#2E86AB", medical_red = "#A23B72", medical_green = "#4CAF50"
- Shapes: Circle, Rectangle, Square, Arrow, Polygon, Line for molecules/receptors
- Text: font="Sans", font_size=32-48, color=BLACK (for white background)
- Animations: FadeIn, GrowFromCenter, Transform, Create, Write
- Labels: Use .next_to(), .to_edge(), .shift() for positioning

Custom Shapes (IMPORTANT):
- For checkmarks, crosses, or custom paths: Use VMobject with set_points_as_corners()
- DO NOT use SVGMobject with path_string (it doesn't exist in Manim)
- Example checkmark:
```python
  checkmark = VMobject()
  checkmark.set_points_as_corners([
      LEFT + DOWN * 0.5,
      ORIGIN,
      RIGHT * 1.5 + UP
  ])
  checkmark.set_stroke(color=GREEN, width=8)
```
- For simple symbols, use Polygon or combine basic shapes

Manim Best Practices:
- Class name MUST be Scene{scene_id} (e.g., Scene1, Scene2)
- Inherit from Scene class
- Use self.play() for animations
- Use self.wait() for pauses between animations
- Group related objects with VGroup
- Use self.camera.background_color = WHITE (not config.background_color)
- For text colors on white background, use BLACK or dark colors

CORRECT Example WITH IMAGE AND NO OVERLAPPING:
```python
from manim import *
from manim import config

class Scene{scene_id}(Scene):
    def construct(self):
        # Set white background
        self.camera.background_color = WHITE
        
        # Define custom colors
        medical_blue = "#2E86AB"
        medical_red = "#A23B72"
        
        # Load background image SAFELY (bottom zone)
        try:
            bg_image = ImageMobject("/path/to/image.jpg")
            bg_image.height = config.frame_height * 0.35  # 35% max
            bg_image.set_opacity(0.6)
            bg_image.to_edge(DOWN, buff=0)
        except Exception as e:
            bg_image = Rectangle(
                width=config.frame_width,
                height=config.frame_height * 0.35,
                fill_color=BLUE_E,
                fill_opacity=0.2,
                stroke_width=0
            ).to_edge(DOWN, buff=0)
        
        # Add image WITHOUT FadeIn (more stable)
        self.add(bg_image)
        self.play(bg_image.animate.set_opacity(0.7), run_time=1)
        
        # Title (top safe zone - no overlap with image)
        title = Text("Medical Title", font="Sans", font_size=44, color=BLACK)
        title.to_edge(UP, buff=0.5)  # Safe distance from top edge
        
        # Description (below title with buffer)
        description = Text("Description text here", font="Sans", font_size=32, color=BLACK)
        description.next_to(title, DOWN, buff=0.4)  # 0.4 buffer prevents overlap
        
        # Ensure description width doesn't overflow
        if description.width > config.frame_width * 0.85:
            description.width = config.frame_width * 0.85
        
        # Animate (everything is in its own space)
        self.play(Write(title))
        self.wait(0.5)
        self.play(Write(description))
        self.wait(2)
        
        # Fade out separately
        self.play(
            FadeOut(title),
            FadeOut(description),
            FadeOut(bg_image),
            run_time=1
        )
        self.wait(0.5)
```

WRONG - DO NOT DO THIS:
```python
# ❌ Elements will overlap
title.move_to(ORIGIN)
subtitle.move_to(ORIGIN)  # Same position!

# ❌ Text might overflow screen
long_text = Text("Very long text...", font_size=48)  # No width constraint

# ❌ Image too large, overlaps with text
bg_image.height = config.frame_height * 0.8  # Takes 80% of screen!

# ✅ CORRECT ways:
title.to_edge(UP, buff=0.5)
subtitle.next_to(title, DOWN, buff=0.4)  # Positioned relative to title
if long_text.width > config.frame_width * 0.85:
    long_text.width = config.frame_width * 0.85  # Constrain width
bg_image.height = config.frame_height * 0.35  # Leaves 65% for other content
```

Generate COMPLETE, WORKING Manim code for this scene. 

VALIDATION CHECKLIST BEFORE RETURNING:
✓ Starts with "from manim import *"
✓ Imports config if using frame dimensions: "from manim import config"
✓ Class name is Scene{scene_id}
✓ Uses self.camera.background_color = WHITE
✓ All text uses color=BLACK (for white background)
✓ All text has width constraint: `if element.width > config.frame_width * 0.85: element.width = config.frame_width * 0.85`
✓ All elements positioned with buff parameter or .next_to() to prevent overlap
✓ Background image height ≤ 35% of frame_height
✓ Elements use safe zones (top for titles, bottom for images, center for content)
✓ Minimum 0.3 units buffer between adjacent elements
✓ If pexels_image_path exists: Uses try/except, .height (not scale_to_fit_width), self.add() then animate opacity
✓ No nested VGroups around ImageMobject in FadeOut
✓ All animations use self.play() or self.wait()
✓ Code is syntactically valid Python

Return ONLY valid JSON:
{{
  "scene_id": {scene_id},
  "manim_code": "from manim import *\\\\nfrom manim import config\\\\n\\\\nclass Scene{scene_id}(Scene):\\\\n    def construct(self):\\\\n        self.camera.background_color = WHITE\\\\n        ..."
}}